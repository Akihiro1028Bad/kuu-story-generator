# バリデーションエラーメッセージ表示方法パターン

## 📋 現在の実装分析

**現在のバリデーション**:
- `handleGenerate`関数内でバリデーションを実行
- エラー時は`console.error`でログ出力のみ
- ユーザーにエラーメッセージが表示されない
- サーバー側のエラーは`state.status === 'error'`で表示されている

**バリデーション対象**:
- 入れる文言（`selectedText`）
- 文字スタイル（`selectedStyles` - 複数選択、最低1つ必要）
- 配置場所（`selectedPosition`）

**問題点**:
- クライアント側のバリデーションエラーが表示されない
- どの項目が不足しているか分からない
- ユーザーが次に何をすべきか分からない

---

## 🎨 エラーメッセージ表示パターン（全8案）

### 案1: 📍 インラインエラー（推奨）

**コンセプト**: 各入力項目の下にエラーメッセージを表示

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ 入れる文言                          │
│ [タグ] [タグ] [タグ]                │
│ ⚠️ 入れる文言を選択してください      │
├─────────────────────────────────────┤
│ 文字スタイル                        │
│ [タグ] [タグ] [タグ]                │
│ ⚠️ 文字スタイルを1つ以上選択してください │
├─────────────────────────────────────┤
│ 配置場所                            │
│ [上] [中] [下]                      │
│ ⚠️ 配置場所を選択してください        │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 🎯 **各項目の下に表示**: どの項目に問題があるか明確
- ⚠️ **アイコン付き**: 視覚的に分かりやすい
- 🔴 **赤色のテキスト**: エラーであることを明確に示す
- 📏 **コンパクト**: スペースを効率的に使用

**実装例**:
```tsx
{errors.textPhrase && (
  <div className="mt-2 flex items-center gap-2 text-error text-sm">
    <svg className="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
      <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
    </svg>
    <span>{errors.textPhrase}</span>
  </div>
)}
```

**メリット**:
- ✅ どの項目に問題があるか明確
- ✅ ユーザーが次に何をすべきか分かる
- ✅ コンパクトで見やすい
- ✅ アクセシビリティが高い

**デメリット**:
- エラーが多いと画面が長くなる

---

### 案2: 🎯 トースト通知

**コンセプト**: 画面の上部または下部に一時的に表示される通知

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ ⚠️ 必須項目が不足しています          │
│ • 入れる文言を選択してください        │
│ • 文字スタイルを1つ以上選択してください │
│ • 配置場所を選択してください          │
│ [閉じる]                             │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 📢 **目立つ位置**: 画面の上部または下部に表示
- ⏱️ **自動非表示**: 数秒後に自動で消える
- 🎨 **アニメーション**: スライドイン/アウト
- 🔴 **警告色**: 赤またはオレンジ色

**実装例**:
```tsx
{showErrorToast && (
  <div className="fixed top-4 left-1/2 transform -translate-x-1/2 z-50">
    <div className="alert alert-error shadow-lg">
      <div>
        <h3 className="font-bold">必須項目が不足しています</h3>
        <ul className="list-disc list-inside">
          {errorMessages.map(msg => <li key={msg}>{msg}</li>)}
        </ul>
      </div>
    </div>
  </div>
)}
```

**メリット**:
- ✅ 目立つ
- ✅ 画面を占有しない
- ✅ モダンなUI

**デメリット**:
- 自動で消えるため、見逃す可能性がある
- どの項目に問題があるか分かりにくい

---

### 案3: 🎨 バナー形式

**コンセプト**: フォームの上部に大きなバナーとして表示

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ ⚠️ 必須項目が不足しています          │
│ 以下の項目を選択してください:         │
│ • 入れる文言                         │
│ • 文字スタイル（1つ以上）             │
│ • 配置場所                           │
└─────────────────────────────────────┘
│ フォーム内容...                      │
```

**デザイン特徴**:
- 📋 **大きなバナー**: フォームの上部に表示
- 📝 **リスト形式**: 不足している項目をリスト表示
- 🔴 **警告色**: 赤またはオレンジの背景
- ❌ **閉じるボタン**: 手動で閉じることができる

**実装例**:
```tsx
{validationErrors.length > 0 && (
  <div className="alert alert-error mb-6">
    <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
    </svg>
    <div>
      <h3 className="font-bold">必須項目が不足しています</h3>
      <ul className="mt-2 list-disc list-inside">
        {validationErrors.map(error => <li key={error}>{error}</li>)}
      </ul>
    </div>
  </div>
)}
```

**メリット**:
- ✅ 目立つ
- ✅ すべてのエラーを一度に表示
- ✅ ユーザーが次に何をすべきか分かる

**デメリット**:
- 画面を占有する
- スクロールが必要になる可能性がある

---

### 案4: 🎯 ボタン周辺に表示

**コンセプト**: 生成ボタンの上または下にエラーメッセージを表示

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ フォーム内容...                      │
├─────────────────────────────────────┤
│ ⚠️ 必須項目が不足しています          │
│ • 入れる文言                         │
│ • 文字スタイル（1つ以上）             │
│ • 配置場所                           │
│ [戻る] [生成する] ← ボタン          │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 📍 **ボタンの近く**: アクションの近くに表示
- 🎯 **コンパクト**: 必要最小限の情報
- 🔴 **警告色**: エラーであることを明確に示す

**実装例**:
```tsx
<div className="mt-8">
  {validationErrors.length > 0 && (
    <div className="mb-4 p-3 bg-error/10 border border-error/30 rounded-lg">
      <div className="flex items-start gap-2">
        <svg className="h-5 w-5 text-error flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
        </svg>
        <div className="flex-1">
          <p className="font-semibold text-error text-sm mb-1">必須項目が不足しています</p>
          <ul className="text-xs text-error/80 list-disc list-inside">
            {validationErrors.map(error => <li key={error}>{error}</li>)}
          </ul>
        </div>
      </div>
    </div>
  )}
  <div className="flex items-center justify-between gap-4">
    <button>戻る</button>
    <button>生成する</button>
  </div>
</div>
```

**メリット**:
- ✅ アクションの近くに表示
- ✅ コンパクト
- ✅ ユーザーが次に何をすべきか分かる

**デメリット**:
- どの項目に問題があるか分かりにくい

---

### 案5: 🎨 ハイライト + インライン

**コンセプト**: エラーがある項目をハイライトし、その下にエラーメッセージを表示

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ 入れる文言                          │
│ ┌─────────────────────────────────┐ │
│ │ [タグ] [タグ] [タグ]            │ │ ← 赤い枠線
│ └─────────────────────────────────┘ │
│ ⚠️ 入れる文言を選択してください      │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 🔴 **赤い枠線**: エラーがある項目をハイライト
- ⚠️ **アイコン + メッセージ**: 項目の下にエラーメッセージ
- 🎯 **視覚的フィードバック**: どの項目に問題があるか明確

**実装例**:
```tsx
<div className={`form-control ${errors.textPhrase ? 'has-error' : ''}`}>
  <label className="label pb-3">
    <span className="label-text font-bold text-lg text-base-content">入れる文言</span>
  </label>
  <div className={`
    overflow-x-auto
    ${errors.textPhrase ? 'ring-2 ring-error rounded-lg' : ''}
  `}>
    {/* タグ */}
  </div>
  {errors.textPhrase && (
    <div className="mt-2 flex items-center gap-2 text-error text-sm">
      <svg className="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
        <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
      </svg>
      <span>{errors.textPhrase}</span>
    </div>
  )}
</div>
```

**メリット**:
- ✅ どの項目に問題があるか非常に明確
- ✅ 視覚的フィードバックが強い
- ✅ ユーザーが次に何をすべきか分かる

**デメリット**:
- 実装がやや複雑

---

### 案6: 📱 モーダルダイアログ

**コンセプト**: エラー時にモーダルダイアログを表示

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│        [背景が暗くなる]              │
│  ┌───────────────────────────────┐  │
│  │ ⚠️ 必須項目が不足しています    │  │
│  │                                │  │
│  │ 以下の項目を選択してください:   │  │
│  │ • 入れる文言                   │  │
│  │ • 文字スタイル（1つ以上）       │  │
│  │ • 配置場所                     │  │
│  │                                │  │
│  │        [OK]                    │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 🎭 **モーダル**: 背景を暗くしてモーダルを表示
- 🎯 **集中**: ユーザーの注意を引く
- ❌ **閉じるボタン**: OKボタンで閉じる

**実装例**:
```tsx
{showErrorModal && (
  <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div className="bg-base-100 rounded-xl p-6 max-w-md w-full mx-4">
      <h3 className="font-bold text-lg mb-4">必須項目が不足しています</h3>
      <ul className="list-disc list-inside mb-4">
        {validationErrors.map(error => <li key={error}>{error}</li>)}
      </ul>
      <button onClick={() => setShowErrorModal(false)} className="btn btn-primary w-full">
        OK
      </button>
    </div>
  </div>
)}
```

**メリット**:
- ✅ 非常に目立つ
- ✅ ユーザーの注意を引く

**デメリット**:
- 操作を中断する
- モバイルでは使いづらい可能性がある
- 実装が複雑

---

### 案7: 🎨 ツールチップ形式

**コンセプト**: ボタンにホバーまたはクリック時にツールチップでエラーを表示

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ フォーム内容...                      │
│                                      │
│ [戻る] [生成する] ← ホバー          │
│         ↑                           │
│    ⚠️ 必須項目が不足しています       │
│    • 入れる文言                      │
│    • 文字スタイル                    │
│    • 配置場所                        │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 💬 **ツールチップ**: ボタンの近くに表示
- 🎯 **コンパクト**: 必要最小限の情報
- ⏱️ **一時的**: ホバーまたはクリック時に表示

**実装例**:
```tsx
<button
  type="submit"
  disabled={hasErrors}
  className="tooltip tooltip-top"
  data-tip={hasErrors ? errorMessages.join(', ') : ''}
>
  生成する
</button>
```

**メリット**:
- ✅ コンパクト
- ✅ 画面を占有しない

**デメリット**:
- ホバーしないと見えない
- モバイルでは使いづらい
- エラーの詳細が分かりにくい

---

### 案8: 🎯 ハイブリッド（インライン + バナー）

**コンセプト**: インラインエラーとバナーを組み合わせた包括的なソリューション

**レイアウト構造**:
```
┌─────────────────────────────────────┐
│ ⚠️ 必須項目が不足しています          │
│ 以下の項目を確認してください          │
└─────────────────────────────────────┘
│ 入れる文言                          │
│ [タグ] [タグ] [タグ]                │
│ ⚠️ 入れる文言を選択してください      │
├─────────────────────────────────────┤
│ 文字スタイル                        │
│ [タグ] [タグ] [タグ]                │
│ ⚠️ 文字スタイルを1つ以上選択してください │
└─────────────────────────────────────┘
```

**デザイン特徴**:
- 📋 **バナー**: フォームの上部に概要を表示
- 📍 **インライン**: 各項目の下に詳細を表示
- 🎯 **包括的**: すべての情報を提供

**実装例**:
```tsx
{validationErrors.length > 0 && (
  <div className="alert alert-error mb-6">
    <div>
      <h3 className="font-bold">必須項目が不足しています</h3>
      <p className="text-sm">以下の項目を確認してください</p>
    </div>
  </div>
)}

{/* 各項目の下にインラインエラーを表示 */}
{errors.textPhrase && (
  <div className="mt-2 text-error text-sm">⚠️ {errors.textPhrase}</div>
)}
```

**メリット**:
- ✅ すべての情報を提供
- ✅ ユーザーが次に何をすべきか分かる
- ✅ 包括的なソリューション

**デメリット**:
- 実装が複雑
- 画面を占有する

---

## 📊 比較表

| 案 | 視認性 | 明確性 | コンパクト性 | 実装難易度 | モバイル対応 | アクセシビリティ |
|---|---|---|---|---|---|---|
| 1. インラインエラー | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 2. トースト通知 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |
| 3. バナー形式 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 4. ボタン周辺 | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |
| 5. ハイライト + インライン | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 6. モーダルダイアログ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| 7. ツールチップ形式 | ⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐ | ⭐⭐ |
| 8. ハイブリッド | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 💡 推奨案

### 🥇 案5: ハイライト + インライン（推奨）

**推奨理由**:
1. **視認性が高い**: エラーがある項目が一目で分かる
2. **明確性**: どの項目に問題があるか非常に明確
3. **ユーザビリティ**: ユーザーが次に何をすべきか分かる
4. **アクセシビリティ**: スクリーンリーダーでも理解しやすい
5. **モバイル対応**: モバイルでも使いやすい

### 🥈 案1: インラインエラー（シンプルな改善）

**推奨理由**:
- 実装が簡単
- コンパクト
- 明確なエラー表示

### 🥉 案8: ハイブリッド（包括的なソリューション）

**推奨理由**:
- すべての情報を提供
- ユーザーが次に何をすべきか分かる
- 包括的なソリューション

---

## 🎨 デザイン詳細（案5: ハイライト + インライン）

### エラー状態のスタイル
- **枠線**: 赤い枠線（`ring-2 ring-error`）
- **背景**: 薄い赤色の背景（`bg-error/5`）
- **アイコン**: 警告アイコン（⚠️）
- **テキスト**: 赤色のテキスト（`text-error`）

### アニメーション
- **フェードイン**: エラーメッセージがフェードイン
- **パルス**: エラーがある項目がパルスアニメーション
- **スムーズなトランジション**: すべての変化がスムーズ

### エラーメッセージの内容
- **入れる文言**: "入れる文言を選択してください"
- **文字スタイル**: "文字スタイルを1つ以上選択してください"
- **配置場所**: "配置場所を選択してください"

---

## 🔧 実装の考慮事項

### バリデーションタイミング
- **リアルタイム**: 選択が変更されるたびにバリデーション
- **送信時**: ボタンをクリックした時にバリデーション
- **ハイブリッド**: 送信時にバリデーション、その後はリアルタイム

### エラー状態の管理
- **状態管理**: `useState`でエラー状態を管理
- **エラーオブジェクト**: `{ textPhrase?: string, styles?: string, position?: string }`
- **クリア**: エラーが修正されたら自動でクリア

### アクセシビリティ
- **aria-live**: エラーメッセージに`aria-live="polite"`を設定
- **aria-invalid**: エラーがある項目に`aria-invalid="true"`を設定
- **aria-describedby**: エラーメッセージと項目を関連付け

### アニメーション
- **フェードイン**: エラーメッセージがフェードイン
- **スライド**: エラーメッセージがスライドイン
- **パルス**: エラーがある項目がパルスアニメーション

---

## 📝 次のステップ

1. **バリデーション関数の作成**: 各項目のバリデーション関数を作成
2. **エラー状態の管理**: エラー状態を管理する状態を追加
3. **エラーメッセージの表示**: 選択した案に基づいてエラーメッセージを表示
4. **アニメーションの追加**: エラーメッセージのアニメーションを追加
5. **アクセシビリティの実装**: アクセシビリティ属性を追加

---

## 💬 フィードバック

各エラーメッセージ表示パターンについて、以下の点を考慮してください：
- 視認性の高さ
- どの項目に問題があるかの明確性
- ユーザーが次に何をすべきかの明確性
- 実装の難易度
- モバイルでの使いやすさ
- アクセシビリティ

